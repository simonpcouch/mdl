---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mdl

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/mdl)](https://CRAN.R-project.org/package=mdl)
<!-- badges: end -->

mdl implements an opinionated and performant reimagining of model matrices. The package supplies one function, `mdl::mtrx()` (read: "model matrix"), that takes in a formula and data frame and outputs a numeric matrix. Compared to its base R friend, `model.matrix()`, it's really, really fast.

**This package is highly experimental. Interpret results with caution!**

## Installation

You can install the development version of mdl like so:

``` r
# install.packages("mdl")
pak::pak("simonpcouch/mdl")
```

## Example

The output of `mdl::mtrx()` looks a lot like that from `model.matrix()`:

```{r}
# convert to factor to demonstrate dummy variable creations
mtcars$cyl <- as.factor(mtcars$cyl)

head(
  mdl::mtrx(mpg ~ ., mtcars)
)
```

Compared to `model.matrix()`, `mdl::mtrx()`:

* Names its intercept `intercept` rather than `(Intercept)`.
* Does not accept formulae with inlined functions (like `-` or `*`).
* Names dummy variables created from characters and factors as `colname_level` rather than `colnamelevel`.
* Names dummy variables create from logicals as `colname` rather than `colnameTRUE`.
* Never drops rows (and thus doesn't accept an `na.action`).
* Assumes that factors levels are encoded as they're intended (i.e. `drop.unused.levels` and `xlev` are not accepted).

It's also _much_ faster:

```{r}
bench::mark(
  mdl::mtrx(mpg ~ ., mtcars),
  model.matrix(mpg ~ ., mtcars),
  check = FALSE
)
```
